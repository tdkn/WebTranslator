{"version":3,"file":"translate.js","mappings":"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","sources":["webpack://webtranslator/./src/content/utils.js","webpack://webtranslator/webpack/bootstrap","webpack://webtranslator/webpack/runtime/define property getters","webpack://webtranslator/webpack/runtime/hasOwnProperty shorthand","webpack://webtranslator/webpack/runtime/make namespace object","webpack://webtranslator/./src/content/translate.js"],"sourcesContent":["\"use strict\";\n\nexport function isVisible(element) {\n  const rect = element.getBoundingClientRect();\n  return rect.top <= window.innerHeight && rect.left <= window.innerWidth;\n}\n\nexport function hasTextNode(element) {\n  const childNodes = element.childNodes;\n  if (childNodes.length === 0) {\n    return false;\n  }\n  return (\n    childNodes[0].nodeType === Node.TEXT_NODE &&\n    childNodes[0].nodeValue.trim() !== \"\"\n  );\n}\n\nexport function hasInlineElement(element) {\n  const children = element.children;\n  if (!children || children.length === 0) {\n    return false;\n  }\n  for (const child of children) {\n    const display = getComputedStyle(child).display;\n    if (display === \"inline\" || display === \"inline-block\") {\n      return true;\n    }\n  }\n}\n\nexport function scrollDidStop(callback, refresh = 200) {\n  let isScrolling;\n  window.addEventListener(\n    \"scroll\",\n    function (event) {\n      window.clearTimeout(isScrolling);\n      isScrolling = setTimeout(callback, refresh);\n    },\n    {\n      once: false,\n      passive: true,\n      capture: true,\n    }\n  );\n}\n\nexport function once(fn, context) {\n  let result;\n  return function () {\n    if (fn) {\n      result = fn.apply(context || this, arguments);\n      fn = undefined;\n    }\n    return result;\n  };\n}\n\nexport function escapeHTML(text) {\n  const div = document.createElement(\"div\");\n  div.textContent = text;\n  return div.innerHTML;\n}\n\nexport function isTouchDevice() {\n  return (\n    \"ontouchstart\" in window ||\n    navigator.maxTouchPoints > 0 ||\n    navigator.msMaxTouchPoints > 0\n  );\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","\"use strict\";\n\nimport {\n  isVisible,\n  hasTextNode,\n  hasInlineElement,\n  once,\n  scrollDidStop,\n} from \"./utils\";\n\nclass App {\n  #uid = 1;\n  #sourceLanguage = undefined;\n  #targetLanguage = undefined;\n  #originalTexts = {};\n  #translatedTexts = {};\n\n  #toast = undefined;\n\n  #isProcessing = false;\n  #shouldProcessAfterScrolling = false;\n  #isShowingOriginal = false;\n\n  setup() {\n    browser.runtime.onMessage.addListener(\n      async (request, sender, sendResponse) => {\n        if (!request) {\n          return;\n        }\n        switch (request.method) {\n          case \"translate\": {\n            this.#shouldProcessAfterScrolling = true;\n\n            await this.#translatePage(request);\n\n            once(\n              scrollDidStop(async () => {\n                if (this.#shouldProcessAfterScrolling) {\n                  await this.#translatePage({\n                    sourceLanguage: this.#sourceLanguage,\n                    targetLanguage: this.#targetLanguage,\n                  });\n                }\n              }, 500)\n            )();\n\n            sendResponse();\n            break;\n          }\n          case \"getContentState\": {\n            if (this.#isProcessing) {\n              sendResponse({ result: { isProcessing: this.#isProcessing } });\n            } else if (Object.keys(this.#originalTexts).length > 0) {\n              sendResponse({\n                result: {\n                  sourceLanguage: this.#sourceLanguage,\n                  targetLanguage: this.#targetLanguage,\n                  isShowingOriginal: this.#isShowingOriginal,\n                },\n              });\n            } else {\n              sendResponse(undefined);\n            }\n            break;\n          }\n          case \"showOriginal\": {\n            this.#shouldProcessAfterScrolling = false;\n            this.#isShowingOriginal = true;\n\n            const elements = document.querySelectorAll(\n              '[data-wtdl-translated=\"true\"]'\n            );\n            for (const element of elements) {\n              const uid = element.dataset.wtdlUid;\n              const originalText = this.#originalTexts[uid];\n              element.innerHTML = originalText;\n              element.dataset.wtdlTranslated = \"false\";\n            }\n            sendResponse();\n            break;\n          }\n          case \"startTranslateSelection\": {\n            const selection = window.getSelection();\n            const textRange = selection.getRangeAt(0);\n            const selectionRect = textRange.getBoundingClientRect();\n\n            const x = selectionRect.left + window.scrollX;\n            const y = selectionRect.bottom + window.scrollY + 30;\n\n            const position = getExistingPopoverPosition();\n            const popover = createPopover(position || { x, y });\n            popover.setAttribute(\"loading\", true);\n\n            sendResponse();\n            break;\n          }\n          case \"finishTranslateSelection\": {\n            const result = request.result;\n            const popover = document.getElementById(\"translate-popover\");\n            if (popover) {\n              if (result.result && result.result.texts) {\n                const text = result.result.texts.map((t) => t.text).join(\"\\n\");\n                popover.setAttribute(\"result\", `${text}`);\n                popover.setAttribute(\"lang\", `${request.targetLanguage || \"\"}`);\n              } else {\n                if (result.error) {\n                  const message = browser.i18n.getMessage(\n                    \"error_message_generic_error\"\n                  );\n                  popover.setAttribute(\"error\", message);\n                } else {\n                  const message = browser.i18n.getMessage(\n                    \"error_message_generic_error\"\n                  );\n                  popover.setAttribute(\"error\", message);\n                }\n              }\n              popover.setAttribute(\"loading\", false);\n            }\n            sendResponse();\n            break;\n          }\n          case \"ping\": {\n            sendResponse({ result: \"pong\" });\n            break;\n          }\n          default: {\n            sendResponse();\n            break;\n          }\n        }\n      }\n    );\n  }\n\n  async #translatePage(request) {\n    const translatedElements = document.querySelectorAll(\n      '[data-wtdl-translated=\"false\"]'\n    );\n    if (this.#targetLanguage === request.targetLanguage) {\n      // Restore translated texts\n      for (const element of translatedElements) {\n        const uid = element.dataset.wtdlUid;\n        const translatedText = this.#translatedTexts[uid];\n        element.innerHTML = translatedText;\n        element.dataset.wtdlTranslated = \"true\";\n      }\n    }\n\n    const visibleElements = await collectVisibleElements();\n    if (visibleElements.length === 0) {\n      this.#cancelTranslation();\n      return;\n    }\n    this.#startTranslation();\n\n    const texts = visibleElements.map((element) => element.text);\n    const response = await browser.runtime.sendMessage({\n      method: \"translate\",\n      texts,\n      sourceLanguage: request.sourceLanguage,\n      targetLanguage: request.targetLanguage,\n    });\n\n    if (response && response.result) {\n      const result = response.result.result;\n      if (result && result.texts) {\n        this.#sourceLanguage = result.lang;\n        this.#targetLanguage = request.targetLanguage;\n\n        const translatedTexts = result.texts;\n        if (translatedTexts.length === visibleElements.length) {\n          for (let i = 0; i < visibleElements.length; i++) {\n            const element = visibleElements[i].element;\n            const text = translatedTexts[i].text;\n            const uid = element.dataset.wtdlUid || this.#uid++;\n\n            if (element.dataset.wtdlOriginal !== \"true\") {\n              this.#originalTexts[uid] = element.innerHTML;\n            }\n            this.#translatedTexts[uid] = text;\n            element.innerHTML = text;\n\n            element.dataset.wtdlUid = `${uid}`;\n            element.dataset.wtdlOriginal = \"true\";\n            element.dataset.wtdlTranslated = \"true\";\n          }\n        }\n      }\n    }\n\n    this.#finishTranslation();\n  }\n\n  #startTranslation() {\n    this.#toast = createToast();\n    this.#toast.setAttribute(\"show\", true);\n\n    this.#isProcessing = true;\n    this.#isShowingOriginal = false;\n\n    browser.runtime.sendMessage({\n      method: \"startTranslation\",\n    });\n  }\n\n  #cancelTranslation() {\n    this.#isShowingOriginal = false;\n\n    browser.runtime.sendMessage({\n      method: \"cancelTranslation\",\n      result: {\n        sourceLanguage: this.#sourceLanguage,\n        targetLanguage: this.#targetLanguage,\n      },\n    });\n  }\n\n  #finishTranslation() {\n    this.#isProcessing = false;\n    this.#toast.setAttribute(\"dismiss\", true);\n\n    browser.runtime.sendMessage({\n      method: \"finishTranslation\",\n      result: {\n        sourceLanguage: this.#sourceLanguage,\n        targetLanguage: this.#targetLanguage,\n      },\n    });\n  }\n}\n\nasync function collectVisibleElements() {\n  const blockElements = [];\n\n  const children = document.body.children;\n  splitElements(children, blockElements);\n\n  const visibleElements = [];\n  for (const element of blockElements) {\n    const visible = isVisible(element);\n    if (\n      visible &&\n      (element.dataset.wtdlUid === undefined ||\n        element.dataset.wtdlTranslated === \"false\")\n    ) {\n      visibleElements.push({ element, text: element.innerHTML });\n    }\n  }\n\n  return visibleElements;\n}\n\nfunction splitElements(elements, storage) {\n  for (const element of elements) {\n    if (\n      element.nodeName !== \"STYLE\" &&\n      element.nodeName !== \"META\" &&\n      element.nodeName !== \"LINK\" &&\n      element.nodeName !== \"SCRIPT\" &&\n      element.nodeName !== \"svg\" &&\n      (hasTextNode(element) || hasInlineElement(element)) &&\n      element.clientTop < window.innerHeight\n    ) {\n      storage.push(element);\n    } else {\n      const children = element.children;\n      if (!children || children.length === 0) {\n        continue;\n      }\n      splitElements(element.children, storage);\n    }\n  }\n}\n\nfunction createToast() {\n  const id = \"translate-toast\";\n  {\n    const toast = document.getElementById(id);\n    if (toast) {\n      toast.remove();\n    }\n  }\n\n  document.body.insertAdjacentHTML(\n    \"beforeend\",\n    `<translate-toast id=\"${id}\"></translate-toast>`\n  );\n  const toast = document.getElementById(id);\n  return toast;\n}\n\nfunction createPopover(position) {\n  const id = \"translate-popover\";\n  {\n    const popover = document.getElementById(id);\n    if (popover) {\n      popover.remove();\n    }\n  }\n\n  document.body.insertAdjacentHTML(\n    \"beforeend\",\n    `<translate-popover id=\"${id}\"></translate-popover>`\n  );\n  const popover = document.getElementById(id);\n  popover.setAttribute(\"position\", JSON.stringify(position));\n\n  const onClick = (event) => {\n    if (event.target.closest(id)) {\n      return;\n    }\n    popover.remove();\n    document.removeEventListener(\"click\", onClick);\n  };\n\n  document.addEventListener(\"click\", onClick);\n  popover.addEventListener(\"close\", async () => {\n    popover.remove();\n    document.removeEventListener(\"click\", onClick);\n  });\n  popover.addEventListener(\"change\", async (event) => {\n    if (!event.detail) {\n      return;\n    }\n    await browser.storage.local.set({\n      selectedSourceLanguage: undefined,\n      selectedTargetLanguage: event.detail.selectedTargetLanguage,\n    });\n\n    const request = {\n      method: \"translateSelection\",\n      selectionText: undefined,\n    };\n    browser.runtime.sendMessage(request);\n  });\n\n  return popover;\n}\n\nfunction getExistingPopoverPosition() {\n  const id = \"translate-popover\";\n  const popover = document.getElementById(id);\n  if (popover) {\n    return popover.getPosition();\n  }\n  return undefined;\n}\n\nconst app = new App();\napp.setup();\n"],"names":["isVisible","element","rect","getBoundingClientRect","top","window","innerHeight","left","innerWidth","hasTextNode","childNodes","length","nodeType","Node","TEXT_NODE","nodeValue","trim","hasInlineElement","children","child","display","getComputedStyle","scrollDidStop","callback","refresh","isScrolling","addEventListener","event","clearTimeout","setTimeout","once","passive","capture","fn","context","result","apply","arguments","undefined","escapeHTML","text","div","document","createElement","textContent","innerHTML","isTouchDevice","navigator","maxTouchPoints","msMaxTouchPoints","App","setup","browser","runtime","onMessage","addListener","request","sender","sendResponse","method","sourceLanguage","targetLanguage","isProcessing","Object","keys","isShowingOriginal","elements","querySelectorAll","uid","dataset","wtdlUid","originalText","wtdlTranslated","selection","getSelection","textRange","getRangeAt","selectionRect","x","scrollX","y","bottom","scrollY","position","getExistingPopoverPosition","popover","createPopover","setAttribute","getElementById","texts","map","t","join","error","message","i18n","getMessage","translatedElements","translatedText","visibleElements","collectVisibleElements","response","sendMessage","lang","translatedTexts","i","wtdlOriginal","createToast","blockElements","body","splitElements","visible","push","storage","nodeName","clientTop","id","toast","remove","insertAdjacentHTML","JSON","stringify","onClick","target","closest","removeEventListener","detail","local","set","selectedSourceLanguage","selectedTargetLanguage","selectionText","getPosition","app"],"sourceRoot":""}